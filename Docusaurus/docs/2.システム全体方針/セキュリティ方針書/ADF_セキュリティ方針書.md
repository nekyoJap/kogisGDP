あなたはセキュリティアーキテクト兼DDDを理解したシステムアーキテクトです。\
以下の【形式】に基づいて、対象システムの「セキュリティ方針書」を作成してください。\
出力はすべてMarkdown形式で記載してください（JSON形式・CSV形式は禁止）。\
また、成果物（表・文章）の提示より先に、**必ず抽出・推論過程をstep-by-stepで記載**し、\
その後に章立てに沿って成果物を順序厳守で出力してください。\
推測による情報補完は禁止し、不明点は必ず「未確定」と明記してください。

---

## 本ドキュメントの位置づけ

* 本書は、セキュリティに関する攻撃からどう守り、データをどう保護するか（Defense & Protection） を定義する
* 特に、**ID管理以外の防御壁（Guardrail）** に関する方針も本書の対象とする。
* 本書の内容は、以下の横断アーキテクチャ・非機能設計文書に拘束力を持つ：
| 対象文書 | 本書との関係 |
|------|--------|
| セキュリティ非機能要件定義書 | 技術レベル・暗号強度・応答時間・閾値を具体化 |
| ロギング／監査方針書 | 記録項目・保管期間・アクセス制御の設計 |
| API仕様書／画面仕様書／外部連携仕様書 | 本書で定めたセキュリティ原則に準拠 |
| システムIaC構成定義書／運用要件定義書 | インフラ・コンテナ・鍵管理などの実装詳細 |

---

## 本書のテーマ・対象範囲（Scope）

**テーマ：**

> 「攻撃からどう守り、データをどう保護するか」 (Defense & Protection)\
> ここには AuthN/AuthZ 以外の **防御壁（Guardrail）** が集約される。
| 防御対象カテゴリ | 内容例 |
|----------|-----|
| データ保護 | DB暗号化 (At Rest)、TLS、PIIマスキング、トークナイズ、ハッシュ化 |
| 脆弱性対策（Secure Coding） | SQL Injection、XSS、CSRF、入力検証、ログに機密を出さない |
| インフラセキュリティ | WAF、セキュリティグループ、ゼロトラスト、コンテナ権限、Secrets管理 |
| サプライチェーン | SBOM（依存管理）、脆弱性スキャン、OSSライセンス管理 |
| AIによる開発防御 | Linter・セキュリティ検閲、禁止事項チェック（生パスワード禁止等） |

---

# 【形式】

第〇章：##\
〇.〇：###\
小見出し：####\
その他：通常テキスト\
表はMarkdown表形式で記載\
JSON / CSV形式は禁止

---

# セキュリティ方針書

---

## 1章：本書の位置付けと目的

### 1.1 本書の目的

本書は、本システム全体に共通するセキュリティの基本方針および防御設計の原則（Defense & Protection）を定義することを目的とする。\
本書で定めた方針は、以下のドキュメントに対しアーキテクチャ上の拘束力を持つ。

* セキュリティ非機能要件定義書
* ロギング／監査方針書
* API仕様書／外部連携仕様書／画面仕様書
* IaC構成定義書／運用要件定義書

### 1.2 本書の適用範囲
| 項目 | 記載内容 |
|----|------|
| 適用範囲 | 本システムを構成するすべてのBC、API、画面、バッチ、インフラ、外部連携を対象とする。 |
| 除外範囲 | 【未確定】（例：他社管理の周辺システム内部実装など） |
| 関係者 | 開発者、運用者、監査担当、セキュリティ責任者、外部連携先 |

---

## 第2章：入力情報と前提

### 2.1 入力アセット

以下の正式インプットを前提とする（添付資料に基づく）：

### 2.2 前提条件

* 本書の方針は、セキュリティ非機能要件・FISC/ISMS 基準と整合していることを前提とする：未確定
* 認証・認可の方式詳細は「認証・認可方針書」によって定義され、本書では原則扱わない。
* 個人情報・決済情報の取り扱いルールは別途「データ保護ポリシー」または「プライバシー方針」に準拠する：未確定
* 開発・運用者は DevSecOps を前提に CI/CD での自動検査を適用する：未確定
* WAF／API GW／FW などの境界防御は提供インフラ仕様に従う：未確定

---

## 第3章：セキュリティ基本原則（多層防御観点）

### 3.1 セキュリティ目標

* 機密性（Confidentiality）
* 完全性（Integrity）
* 可用性（Availability）
* 責任追跡性（Accountability）
* 防御継続性（Resilience） ←新設

### 3.2 防御設計の原則（Defense-in-Depth）
| 観点 | 方針 |
|----|----|
| 多層防御 | 複数の防御層（認証・API・WAF・通信・DB・監査）で保護する |
| ゼロトラスト | 信頼境界を設けない。全ての通信・操作を検証する |
| 最小権限 | すべてのアクセスは必要最小限 |
| 安全なデフォルト | Default Deny / Private |
| 侵害前提設計 | 「侵入される」ことを前提とし、検知・封じ込めを重視 |

---

## 第4章：認証・認可との関係整理（境界定義）

認証・認可方式そのものは「認証・認可方針書」に記載する。\
本書では、防御設計に関わる以下の内容のみ記載する。
| 項目 | 本書で扱う観点 |
|----|---------|
| トークン保護 | 暗号化、漏洩時の失効、保管禁止、ログ禁止 |
| セッション保護 | 固定化・盗聴防止／Secure Cookie／HttpOnly |
| API権限制御 | レートリミット／API Gateway／WAF検知ブロック |

➡ RBAC / ABAC / MFA / OAuth2.0 の方式定義は扱わない（認証・認可方針書で管理）

---

## 第5章：データ保護・プライバシー方針

### 5.1 データ分類
| 区分 | 例 | 保護レベル |
|----|---|-------|
| 特定個人情報 | マイナンバー等 | 最高 |
| 決済機密情報 | カード番号／CVV | 最高 |
| 個人情報 | 氏名／住所／連絡先 | 高 |
| 与信審査情報 | 属性／スコア／申込履歴 | 高 |
| 業務情報 | マスタ／取引情報 | 中 |
| 公開情報 | 店舗一覧 等 | 低 |

### 5.2 暗号化・マスキング・トークナイズ方針
| 項目 | 方針 |
|----|----|
| 保存時暗号化 | DB / S3 / Backup に対して AES-256等で実施 |
| 通信時暗号化 | すべての通信経路をTLS1.3以上に統一 |
| マスキング | 画面・ログ・監査対象ではマスキング必須 |
| トークナイズ | PII・決済情報にはトークナイズを優先採用 |
| ハッシュ化 | パスワードなど不可逆データはハッシュ保存 |
| ログ制御 | 生データ、トークン、鍵情報を記録禁止 |

---

## 第6章：インタフェース別セキュリティ方針

### 6.1 API
| 観点 | 方針 |
|----|----|
| WAF | SQLi/XSS試行検知で即時遮断 |
| レート制限 | 外部API／公開APIに必須 |
| 入力検証 | 想定外／未定義形式は拒否 |
| 改ざん検知 | 署名付きリクエスト推奨 |

### 6.2 画面(UI)
| 観点 | 方針 |
|----|----|
| CSRF対策 | トークン制御必須 |
| XSS対策 | エスケープ＋CSP設定 |
| セッション管理 | Secure/HttpOnly/Cookie制御 |
| スクリーンショット対策 | マスキング等の実装 |

### 6.3 外部連携
| 観点 | 方針 |
|----|----|
| 接続先検証 | 証明書・署名検証必須 |
| データ最小化 | 最小限データのみ送信 |
| 依存サービスの脆弱性 | 定期スキャン・更新ルール化 |

---

## 第7章：開発／運用における防御方針（DevSecOps）

### 7.1 Secure Coding
| 項目 | 指針 |
|----|----|
| SQL Injection | ORM使用／文字列結合禁止 |
| XSS | 出力エスケープ／CSP設定 |
| CSRF | Token方式必須 |
| ログ | 生パスワード／機密出力禁止 |
| 入力検証 | 型、長さ、形式、範囲制御 |

### 7.2 サプライチェーン・AI開発防御
| 項目 | 方針 |
|----|----|
| SBOM管理 | 使用OSS／依存関係は全て可視化 |
| 脆弱性スキャン | バージョン変更時・リリース前に実施 |
| AI Linter | セキュリティ禁則事項を自動チェック |
| 秘密情報 | Git／ログ／AIチャット上で共有禁止 |

---

## 第8章：ログ・監査・証跡に関する方針
| 観点 | 方針 |
|----|----|
| 記録対象 | 認証／認可／重要データアクセス／設定変更 |
| ログ保護 | WORM／署名／アクセス制限 |
| トレーサビリティ | 誰が／いつ／何にアクセスしたか記録 |
| 不正検知 | 合理的な閾値・異常検知ルール定義 |

