---
id: TQPZZZZ001
title: テスト・品質保証方針書
sidebar_position: 1
---

# テスト・品質保証方針書

| 項目 | 内容 |
|------|------|
| ドキュメントID | TQPZZZZ001 |
| 版数 | 1.0 |
| 作成日 | 2026-01-15 |
| 最終更新日 | 2026-01-15 |
| ステータス | ドラフト |

---

## 第1章 適用範囲

### 1.1 目的

本書は、ハウスクレジット基幹システムにおける品質保証・テストの共通方針を定め、DDD＋SBE（Specification by Example）＋TDD を基盤とした品質保証の枠組みを確立することを目的とする。

本書は、設計・実装フェーズにおける品質確保の基盤であり、単なるテスト計画書ではない。開発プロセス全体を通じた品質の作り込みと検証の方針を定義する。

### 1.2 適用範囲

**表1 — 適用範囲**

| 項目 | 記述内容 |
|------|----------|
| 対象システム | ハウスクレジット基幹システム |
| 対象BC | ドメインスコープ定義書およびコンテキストマップに定義された全BC |
| 対象フェーズ | 設計・実装・テスト・運用 |
| 除外対象 | テスト計画書の詳細（別途作成）、具体的なテストケース |

### 1.3 関連文書

**表2 — 関連文書一覧**

| 関連ドキュメント | 関係性 |
|------------------|--------|
| ソフトウェアアーキテクチャ方針書 | SBE/Living Documentationの詳細を参照 |
| セキュリティ方針書 | セキュリティテスト要件を参照 |
| 例外処理ポリシー | エラーハンドリングのテスト方針を参照 |
| トランザクション方針書 | トランザクション制御のテスト方針を参照 |
| 非機能要件定義書 | 性能・可用性テスト要件を参照（未確定） |

---

## 第2章 引用規格

本書は以下の規格・標準を参照する：

- ISO/IEC 25010:2011 システム及びソフトウェア品質モデル
- ISO/IEC/IEEE 29119 ソフトウェアテスト
- ISO/IEC 9126 ソフトウェア品質特性

---

## 第3章 用語及び定義

本書で使用する主要な用語を以下に定義する。

**表3 — 用語定義**

| 用語 | 定義 |
|------|------|
| SBE | Specification by Example。具体例による仕様定義 |
| TDD | Test-Driven Development。テスト駆動開発 |
| BDD | Behavior-Driven Development。振る舞い駆動開発 |
| Living Documentation | 実行可能なテストから生成される常に最新の仕様書 |
| Gherkin | SBEで使用するビジネス可読な仕様記述言語 |
| ユビキタス言語 | BC内で共通に使用される業務用語 |
| モック | テスト対象の依存オブジェクトを模擬するオブジェクト |
| スタブ | テスト用の固定された値を返すダミーオブジェクト |

---

## 第4章 品質保証基本方針

### 4.1 品質目標

品質保証の目標を以下のように定める。

**表4 — 品質目標**

| 目標 | 説明 | 測定方法 |
|------|------|---------|
| 仕様とコードの整合性 | SBE/Living Documentationにより、仕様とコードの乖離を防止しなければならない | Living Documentation生成率 |
| 早期欠陥検出 | TDDにより、実装段階で欠陥を検出しなければならない | 単体テスト段階での欠陥検出率 |
| 継続的品質検証 | CI/CDパイプラインでテストを継続的に実行しなければならない | 自動テスト実行頻度 |
| トレーサビリティ | 要件→仕様→テスト→コードの追跡可能性を確保しなければならない | トレーサビリティマトリクス完成度 |
| 高いカバレッジ | ドメインロジックの網羅的なテストを実施しなければならない | コードカバレッジ率 |

### 4.2 品質保証の原則

**表5 — 品質保証原則**

| 原則 | 説明 |
|------|------|
| シフトレフト | テストを開発プロセスの早期に組み込まなければならない |
| 自動化優先 | 繰り返し実行するテストは自動化しなければならない |
| 継続的フィードバック | テスト結果を迅速にフィードバックしなければならない |
| テストピラミッド | ユニットテストを基盤とし、E2Eテストは最小限とすることが望ましい |
| 失敗から学ぶ | 欠陥が発生した場合は、その原因分析と再発防止を実施しなければならない |

### 4.3 品質保証体制

**表6 — 品質保証体制**

| 役割 | 責任 |
|------|------|
| 開発者 | 単体テスト・統合テストの実装と実行 |
| QAエンジニア | テスト戦略の策定、E2Eテストの実装と実行 |
| プロダクトオーナー | 受け入れ基準の定義、受け入れテストの実施 |
| アーキテクト | テスト方針の策定、アーキテクチャテストの定義 |

---

## 第5章 テストレベル・種別方針

### 5.1 テストレベル

各テストレベルの目的と実施方針を定義する。

**表7 — テストレベル定義**

| レベル | 目的 | 責任 | カバレッジ目標 | 実施タイミング |
|--------|------|------|---------------|---------------|
| ユニットテスト | 単一クラス・関数の動作検証 | 開発者 | 70%以上（未確定） | 実装時 |
| 統合テスト | コンポーネント間の連携検証 | 開発者/QA | 主要パスをカバー | ユニットテスト後 |
| E2Eテスト | ユーザーシナリオの検証 | QA | 主要シナリオをカバー | 統合テスト後 |
| 受け入れテスト | ビジネス要件の充足検証 | PO/ユーザー | 全ユーザーストーリー | リリース前 |

#### 5.1.1 ユニットテスト

**表8 — ユニットテスト方針**

| 項目 | 方針 |
|------|------|
| 対象 | 集約、エンティティ、VO、ドメインサービス、ユースケース |
| 範囲 | 単一クラスまたは関数 |
| 依存関係 | モック・スタブを使用して外部依存を排除しなければならない |
| 実行速度 | 高速に実行できなければならない（1テスト<100ms目安） |
| 独立性 | 各テストは独立して実行可能でなければならない |

#### 5.1.2 統合テスト

**表9 — 統合テスト方針**

| 項目 | 方針 |
|------|------|
| 対象 | BC内のコンポーネント間連携、外部システム連携 |
| 範囲 | 複数コンポーネント、API、DB連携 |
| 環境 | テスト用DB・外部システムを使用する |
| データ | テストデータを準備し、テスト後にクリーンアップしなければならない |

#### 5.1.3 E2Eテスト

**表10 — E2Eテスト方針**

| 項目 | 方針 |
|------|------|
| 対象 | ユーザーシナリオ全体 |
| 範囲 | UI→API→DB→外部システムの全体フロー |
| 優先度 | クリティカルパス・主要ユースケースを優先する |
| 実行頻度 | CI/CD、リリース前、定期実行 |

### 5.2 テスト種別

**表11 — テスト種別定義**

| 種別 | 目的 | 実施タイミング | 自動化 |
|------|------|---------------|--------|
| 機能テスト | 機能要件の検証 | 各フェーズ | 必須 |
| 性能テスト | 性能要件の検証 | 統合テスト以降 | 推奨 |
| セキュリティテスト | セキュリティ要件の検証 | 統合テスト以降 | 推奨 |
| 回帰テスト | 変更による影響の検証 | 各変更時 | 必須 |
| 探索的テスト | 未知の欠陥の発見 | 各フェーズ | 不可 |
| ユーザビリティテスト | UI/UXの検証 | UI実装後 | 一部可 |

---

## 第6章 SBE/Gherkin テスト方針

### 6.1 Gherkin 記述方針

Gherkinによる仕様記述は、以下の原則に従わなければならない。

**表12 — Gherkin記述原則**

| 原則 | 説明 |
|------|------|
| ユビキタス言語 | BCのユビキタス言語を使用しなければならない |
| ビジネス視点 | 技術詳細ではなくビジネス視点で記述しなければならない |
| 具体例 | 抽象的なルールではなく具体例で記述しなければならない |
| 独立性 | 各シナリオは独立して実行可能でなければならない |
| 検証可能性 | Then句で検証可能な期待結果を記述しなければならない |

#### 6.1.1 Gherkin構文

Given-When-Then形式で記述しなければならない。

**表13 — Given-When-Then構文**

| 句 | 役割 | 記述内容 |
|----|------|---------|
| Given | 前提条件 | テスト実行前の状態を記述する |
| When | 実行 | テスト対象の操作を記述する |
| Then | 期待結果 | 期待される結果を記述する |
| And | 追加 | Given/When/Thenに追加条件を記述する |
| But | 否定 | 期待されない結果を記述する |

### 6.2 Gherkin ファイル管理

**表14 — Gherkinファイル管理方針**

| 項目 | 方針 |
|------|------|
| 配置 | BC単位のディレクトリに配置しなければならない |
| 命名 | `{ユースケース名}.feature` の形式で命名しなければならない |
| バージョン管理 | ソースコードと同一リポジトリで管理しなければならない |
| レビュー | プルリクエスト時にレビューしなければならない |
| 言語 | 日本語で記述することが望ましい |

### 6.3 Living Documentation生成

Gherkinから自動的にLiving Documentationを生成しなければならない。

**表15 — Living Documentation要件**

| 要件 | 説明 |
|------|------|
| 自動生成 | CI/CDパイプラインで自動生成しなければならない |
| 最新性 | テスト実行結果を反映しなければならない |
| アクセス性 | 関係者がアクセス可能な場所に公開しなければならない |
| トレーサビリティ | 要件とのトレーサビリティを確保しなければならない |

---

## 第7章 TDD 方針

### 7.1 TDD サイクル

TDDは、Red-Green-Refactorのサイクルで実施しなければならない。

**表16 — TDDサイクル**

| ステップ | 説明 | 実施内容 |
|---------|------|---------|
| Red | 失敗するテストを書く | 仕様を表現するテストを先に実装しなければならない |
| Green | テストが通る最小限の実装 | テストが通る最小限のコードを実装しなければならない |
| Refactor | コードを改善する | テストを維持しながらコードを改善しなければならない |

### 7.2 TDD 適用範囲

**表17 — TDD適用範囲**

| 対象 | 適用 | 理由 |
|------|------|------|
| ドメインロジック | 必須 | ビジネスロジックの正確性が最重要 |
| ユースケース | 必須 | ユースケースの動作保証が必要 |
| アダプタ層 | 推奨 | 外部連携の動作保証が望ましい |
| インフラ層 | 推奨 | 技術的な実装の動作保証が望ましい |
| UI | 任意 | コスト対効果を考慮して判断 |

### 7.3 テストダブル使用方針

**表18 — テストダブル使用方針**

| 種類 | 用途 | 使用場面 |
|------|------|---------|
| モック | 振る舞いの検証 | メソッド呼び出しの検証が必要な場合 |
| スタブ | 固定値の返却 | 外部依存の排除が必要な場合 |
| スパイ | 呼び出し情報の記録 | 呼び出し履歴の確認が必要な場合 |
| フェイク | 簡易実装 | 軽量な動作する実装が必要な場合 |

---

## 第8章 テスト自動化方針

### 8.1 自動化対象

**表19 — 自動化対象**

| テスト種別 | 自動化 | 実施頻度 | 備考 |
|-----------|--------|---------|------|
| ユニットテスト | 必須 | 毎コミット | カバレッジ閾値を設定しなければならない |
| 統合テスト | 必須 | 毎プルリクエスト | APIレベルでの検証 |
| E2Eテスト | 推奨 | 毎日/リリース前 | 主要シナリオを対象 |
| 性能テスト | 推奨 | 週次/リリース前 | 性能劣化の早期検出 |
| セキュリティテスト | 推奨 | 週次/リリース前 | SAST/DAST |
| 回帰テスト | 必須 | 毎プルリクエスト | 全自動テストを実行 |

### 8.2 CI/CD 統合

CI/CDパイプラインにテストを統合しなければならない。

**表20 — CI/CD統合方針**

| 項目 | 方針 |
|------|------|
| テスト実行 | プルリクエスト時に自動実行しなければならない |
| 品質ゲート | テスト失敗時はマージを禁止しなければならない |
| カバレッジ | 閾値を下回る場合は警告しなければならない |
| 実行時間 | 10分以内に完了することが望ましい（ユニット+統合） |
| 失敗時対応 | 失敗時は即座に通知しなければならない |

### 8.3 テスト環境

**表21 — テスト環境方針**

| 環境 | 用途 | 構成 |
|------|------|------|
| ローカル開発環境 | ユニットテスト | 開発者PC |
| CI環境 | 自動テスト | コンテナベース |
| 統合テスト環境 | 統合テスト | 本番相当構成（縮小版） |
| ステージング環境 | E2Eテスト・受け入れテスト | 本番相当構成 |

---

## 第9章 テストデータ管理

### 9.1 テストデータ準備

**表22 — テストデータ準備方針**

| 項目 | 方針 |
|------|------|
| データ生成 | テストごとに必要なデータを準備しなければならない |
| データ独立性 | テスト間でデータを共有してはならない |
| データクリーンアップ | テスト後にデータをクリーンアップしなければならない |
| 匿名化 | 本番データを使用する場合は匿名化しなければならない |

### 9.2 テストデータパターン

**表23 — テストデータパターン**

| パターン | 使用場面 |
|---------|---------|
| 境界値 | 境界値テストで使用 |
| 正常値 | 正常系テストで使用 |
| 異常値 | 異常系テストで使用 |
| 等価クラス | 等価分割テストで使用 |

---

## 第10章 アーキテクチャテスト

### 10.1 アーキテクチャテスト方針

アーキテクチャの整合性を自動テストで検証しなければならない。

**表24 — アーキテクチャテスト方針**

| 項目 | 検証内容 |
|------|---------|
| レイヤー依存 | レイヤー間の依存方向を検証しなければならない |
| BC境界 | BC間の依存関係を検証しなければならない |
| 命名規約 | クラス・パッケージの命名規約を検証しなければならない |
| 集約整合性 | 集約の境界とトランザクション境界を検証しなければならない |

### 10.2 推奨ツール

**表25 — アーキテクチャテストツール**

| ツール | 用途 |
|--------|------|
| ArchUnit | Javaのアーキテクチャテスト |
| NetArchTest | .NETのアーキテクチャテスト |
| 言語依存 | 各言語に応じたツールを選定する |

---

## 第11章 性能テスト

### 11.1 性能テスト種別

**表26 — 性能テスト種別**

| 種別 | 目的 | 実施タイミング |
|------|------|---------------|
| 負荷テスト | 通常負荷での性能検証 | 統合テスト以降 |
| ストレステスト | 限界負荷での性能検証 | リリース前 |
| スパイクテスト | 急激な負荷増加への対応検証 | リリース前 |
| 耐久テスト | 長時間稼働での性能検証 | リリース前 |

### 11.2 性能テスト観点

**表27 — 性能テスト観点**

| 観点 | 測定項目 | 目標値 |
|------|---------|--------|
| 応答時間 | API応答時間 | 未確定 |
| スループット | 秒間処理件数 | 未確定 |
| リソース使用率 | CPU/メモリ使用率 | 未確定 |
| エラー率 | エラー発生率 | 1%未満 |

---

## 第12章 セキュリティテスト

### 12.1 セキュリティテスト種別

**表28 — セキュリティテスト種別**

| 種別 | 目的 | 実施方法 |
|------|------|---------|
| SAST | 静的コード解析 | 自動ツール |
| DAST | 動的セキュリティテスト | 自動ツール |
| ペネトレーションテスト | 侵入テスト | 専門家による実施 |
| 脆弱性診断 | 既知脆弱性の検証 | 自動ツール |

### 12.2 セキュリティテスト観点

**表29 — セキュリティテスト観点**

| 観点 | 検証内容 |
|------|---------|
| 認証・認可 | 不正アクセスの防止 |
| 入力検証 | インジェクション攻撃の防止 |
| 暗号化 | データ保護の検証 |
| セッション管理 | セッションハイジャックの防止 |
| エラーハンドリング | 情報漏洩の防止 |

---

## 第13章 品質メトリクス

### 13.1 品質メトリクス定義

**表30 — 品質メトリクス**

| メトリクス | 説明 | 閾値 | 測定頻度 |
|-----------|------|------|---------|
| コードカバレッジ | テスト対象コードの割合 | 70%以上（未確定） | 毎コミット |
| 欠陥密度 | KLOCあたりの欠陥数 | 未確定 | 毎スプリント |
| テスト成功率 | 成功テスト/全テスト | 100%必須 | 毎実行 |
| 欠陥検出率 | 各フェーズでの欠陥検出数 | 未確定 | 毎スプリント |
| 欠陥修正時間 | 欠陥発見から修正までの時間 | 未確定 | 毎スプリント |

### 13.2 品質ダッシュボード

品質メトリクスを可視化するダッシュボードを構築しなければならない。

**表31 — ダッシュボード要件**

| 要件 | 説明 |
|------|------|
| リアルタイム性 | CI/CD実行後、即座に更新しなければならない |
| アクセス性 | チーム全員がアクセス可能でなければならない |
| トレンド表示 | 時系列でのトレンドを表示しなければならない |
| アラート | 閾値を下回った場合に通知しなければならない |

---

## 第14章 欠陥管理

### 14.1 欠陥分類

**表32 — 欠陥分類**

| 分類 | 説明 | 優先度 |
|------|------|--------|
| Critical | システム停止・データ損失 | 最高 |
| High | 主要機能の不具合 | 高 |
| Medium | 一部機能の不具合 | 中 |
| Low | 軽微な不具合 | 低 |

### 14.2 欠陥ライフサイクル

**表33 — 欠陥ライフサイクル**

| ステータス | 説明 |
|-----------|------|
| Open | 欠陥を発見 |
| Assigned | 担当者をアサイン |
| In Progress | 修正作業中 |
| Fixed | 修正完了 |
| Verified | 修正確認完了 |
| Closed | クローズ |
| Reopened | 再発生 |

---

## 第15章 テストレポート

### 15.1 レポート種別

**表34 — テストレポート種別**

| レポート | 目的 | 頻度 |
|---------|------|------|
| 日次レポート | CI/CD実行結果 | 毎日 |
| スプリントレポート | スプリントの品質状況 | スプリント終了時 |
| リリースレポート | リリース判定資料 | リリース前 |
| 品質分析レポート | 品質傾向分析 | 月次 |

### 15.2 レポート内容

**表35 — テストレポート必須項目**

| 項目 | 内容 |
|------|------|
| 実行サマリ | テスト実行数・成功率・失敗率 |
| カバレッジ | コードカバレッジ・要件カバレッジ |
| 欠陥サマリ | 新規欠陥・未修正欠陥・修正済み欠陥 |
| リスク分析 | 品質リスクの評価 |
| 推奨事項 | 改善提案 |

---

## 付録A 未確定事項一覧

本方針書において「未確定」と記載された事項を以下にまとめる。これらは後続の検討・合意形成により確定させなければならない。

**表A.1 — 未確定事項一覧**

| 章節 | 項目 | 備考 |
|------|------|------|
| 5.1 | コードカバレッジ目標値 | プロジェクト特性に応じて設定が必要 |
| 1.3 | 非機能要件定義書の存在 | 別途作成が必要 |
| 11.2 | 性能テスト目標値 | 非機能要件に基づき設定が必要 |
| 13.1 | 各種メトリクスの閾値 | プロジェクト特性に応じて設定が必要 |

---

## 付録B 検討が必要な論点

以下は、本方針書の運用にあたり検討が必要な論点である。

1. **テストツールの選定**
   - ユニットテストフレームワーク（JUnit、NUnit、pytest等）
   - E2Eテストツール（Selenium、Playwright、Cypress等）
   - 性能テストツール（JMeter、Gatling、K6等）
   - BDDツール（Cucumber、SpecFlow等）

2. **カバレッジ目標の設定**
   - ドメイン層のカバレッジ目標値
   - 全体のカバレッジ目標値
   - カバレッジ測定対象の範囲

3. **テスト実行戦略**
   - 並列実行の可否と方法
   - テスト実行順序の最適化
   - 失敗時のリトライ戦略

4. **テストデータ管理**
   - テストデータ生成の自動化
   - テストデータのバージョン管理
   - 本番データの匿名化方法

5. **性能テスト基準値の設定**
   - 応答時間の目標値
   - スループットの目標値
   - リソース使用率の閾値
   - 性能劣化の許容範囲

6. **セキュリティテストの実施体制**
   - 専門家の関与範囲
   - ペネトレーションテストの実施頻度
   - 脆弱性対応のプロセス

7. **品質メトリクスの具体化**
   - 各メトリクスの具体的な閾値設定
   - メトリクスの測定方法
   - メトリクスの可視化方法

8. **Living Documentationツールの選定**
   - Cucumber等のBDDツールの選定
   - ドキュメント生成ツールの選定
   - 公開方法（Docusaurus、Confluence等）

9. **テスト自動化の優先順位**
   - 自動化対象の優先順位付け
   - 自動化のROI評価
   - 段階的な自動化の進め方

10. **継続的改善プロセス**
    - テストプロセスの定期的な見直し
    - 品質メトリクスに基づく改善活動
    - ベストプラクティスの共有

---
